# refine-japanese

## 概要

指定されたファイルの日本語を読みやすく整形する対話型コマンドです。

## ⚠️ 重要な注意事項

- 変更は**段階的に提示**し、ユーザーの確認を得てください
- 技術文書の場合、**専門用語の正確性を重視**してください
- **コードブロックおよびインラインコード（`...`）内のテキストは整形対象外**としてください

## 実行手順

### 1. 対象ファイルの確認と読み込み

- 引数で指定されたファイルパスを確認してください
- ファイルが存在することを確認し、内容を読み込んでください

エラーハンドリング：

1. **ファイル未指定**
   - エラー：「整形対象のファイルを指定してください」を出力し、処理を終了
2. **ファイル不存在**
   - エラー：「指定されたファイルが見つかりません」を出力し、処理を終了
3. **読み取り権限なし**
   - エラー：「ファイルの読み取り権限がありません」を出力し、処理を終了
4. **バイナリファイル**
   - エラー：「テキストファイルではありません」を出力し、処理を終了
5. **空ファイル**
   - エラー：「整形対象のテキストがありません」を出力し、処理を終了

### 2. 整形レベルの選択

整形の詳細度を選択してもらってください：

```text
整形レベルを選択してください：
1. ⭐ Basic (基本) - 句読点と文体の統一
2. ⭐⭐ Standard (標準) - 基本 + 読みやすさ改善
3. ⭐⭐⭐ Advanced (詳細) - 標準 + 文章構成の最適化

選択してください:
```

- ユーザーが番号を選択したら、対応する整形レベルを記録してください
- 1、2、3のいずれでもない値が入力された場合は「無効な番号です。再度入力してください」と再入力を促してください

### 3. 整形内容の分析と実施

選択された整形レベルに応じて、以下の観点で整形を実施してください：

#### Level 1 (Basic) - 基本整形

- [ ] 句読点の統一
  - 文末の句点「。」の確認
  - 読点「、」の適切な配置
  - 英文内の句読点との混在を整理

- [ ] 文体の統一
  - です・ます調 / である調の一貫性
  - 敬語表現の統一

- [ ] 半角・全角の統一
  - 英数字は半角
  - カタカナは全角
  - 記号の統一

#### Level 2 (Standard) - 標準整形

- [ ] Level 1の全項目

- [ ] 読みやすさの改善
  - 文字数が80文字以上の文を分割提案（句読点を含む、インラインコードを除く）
  - 箇条書きフォーマットの統一（「-」を標準とする）
  - 適切な改行位置の提案

#### Level 3 (Advanced) - 詳細整形

- [ ] Level 2の全項目

- [ ] 文章構成の最適化
  - 段落構成の改善提案
  - 見出しレベルの整合性確認
  - 論理的な流れの確認

- [ ] 表現の改善
  - 冗長な表現の簡潔化
  - あいまいな表現の明確化
  - 読み手を意識した表現への改善

### 4. 整形結果の提示

変更内容を分析し、以下の形式で整形結果を提示してください。
変更がない場合は「整形が必要な箇所はありませんでした」と報告してください。

**出力ルール:**

- テンプレートの内容のみを出力する
- テキスト形式で出力する（```text```ブロックで囲む）
- 整形チェックリストは出力しない（内部参照用）
- テンプレート以外の説明や補足は追加しない
- 角括弧で始まる指示行（例: `[選択された…]`）は出力しない
- 「例: …」と示された例示行は実データに置き換えるか、該当がなければ出力しない
- `${...}` の変数は実データで置き換える（未取得の場合は「なし」等の明示語に置換）
- `[...]` のプレースホルダはAIが適切な内容を生成して置き換える

**出力テンプレート:**

```text
========================================
📝 整形提案
========================================

整形レベル: [選択されたレベル] 例: ⭐⭐ Standard (標準)
────────────────────────────────────────

🔍 提案詳細
────────────────────────────────────────

✂️ 基本整形 ([件数])
[具体的な変更箇所と理由]
例: • 「〜です」と「〜である」が混在 → 「〜です」に統一 (line 15-20)
例: • 文末に句点なし → 句点を追加 (line 42)

📐 読みやすさ改善 ([件数])
[長文分割や箇条書きの改善]
例: • 85文字の文 → 2文に分割を提案 (line 67)
例: • 箇条書きのマーカー統一（「・」→「-」）(line 89-95)

🎯 構成最適化 ([件数])
[段落構成や見出しレベルの改善提案]
例: • 見出しレベルがh2からh4に飛んでいる箇所あり (line 120)
例: • 1段落が300文字を超えている → 2段落に分割を提案 (line 145-160)
```

### 5. 変更の適用確認

整形結果を提示した後、以下のように適用確認を行ってください：

```text
上記の整形提案を適用しますか？
1. すべて適用
2. 一部選択して適用
3. 適用しない

選択してください:
```

- **すべて適用**：ファイルに変更を書き込み
- **一部選択して適用**：各変更項目を個別に確認し、選択的に適用
- **適用しない**：処理を終了
