# 変更要約

## 概要

ローカルリポジトリの変更内容を分析し、説明文を生成する対話型コマンドです。

## 実行手順

### 1. 現在の状態確認

現在のブランチと作業状況を把握してください：

```bash
# 現在のブランチを確認
git branch --show-current

# 未コミットの変更を確認
git status --short
```

### 2. ベースブランチの選択

```bash
# 現在のブランチ以外のローカルブランチを取得
git branch | grep -v '^\*' | sed 's/^  //'
```

- 他のローカルブランチが存在する場合：
  - 番号付きリストでベースブランチを表示してください
  - ユーザーが番号を選択したら、そのブランチをベースとして使用してください
  - 無効な番号が入力された場合は「無効な番号です。もう一度番号を入力してください」と再入力を促してください
- ローカルブランチが存在しない場合：
  - 「比較可能なブランチがありません」と表示して処理を終了してください

### 3. 差分の取得と分析

選択されたベースブランチとの差分を取得し、変更内容を分析してください：

```bash
# 1. 差分の統計情報を取得
git diff ${selected_branch}...HEAD --stat

# 2. 変更されたファイル一覧を取得
git diff ${selected_branch}...HEAD --name-status

# 3. 実際の差分内容を取得して分析
git diff ${selected_branch}...HEAD
```

- 変更がない場合：
  - 「変更内容がありません」を出力し、処理を終了してください

収集した情報をもとに、以下を理解してください：

- 追加/変更/削除された機能
- 変更の主な目的
- 技術的な実装方法
- 影響範囲

### 4. 説明文の生成

以下のルールに従って出力してください：

**出力ルール:**

- テンプレートの内容のみを出力する
- テキスト形式で出力する（```text```ブロックで囲む）
- テンプレート以外の説明や補足は追加しない
- 角括弧で始まる指示行（例: `[変更の概要]`）は実際の内容に置き換える
- 「例: ...」と示された例示行は実データに置き換えるか、該当がなければ出力しない
- 変更を機能単位や関連性でグループ化する
- 各グループは絵文字と見出しで始める
- 見出しは変更の概要を端的に表現する
- 箇条書きは具体的な作業内容を記述する
- 簡潔で分かりやすい表現を使用する
- 技術的な詳細は必要最小限にする

**出力テンプレート:**

```text
========================================
📋 変更要約
========================================

◆ [変更の概要1]

• [具体的な作業1]
• [具体的な作業2]
• [具体的な作業3]

◆ [変更の概要2]

• [具体的な作業1]
• [具体的な作業2]

◆ [変更の概要3]

• [具体的な作業1]
• [具体的な作業2]
• [具体的な作業3]
```

**出力例:**

```text
========================================
📋 変更要約
========================================

◆ 電話番号ログイン機能の追加

• usersテーブルにphoneカラムを追加
• Userモデルにphone属性を追加
• SMSによる認証コード送信機能を実装
• 電話番号でのログインAPIエンドポイントを作成

◆ パスワードリセット機能の改善

• メール再送機能を実装
• レート制限を追加（1分間に1回まで）
• 再送時のエラーメッセージを改善

◆ APIレスポンス形式の統一

• 全エンドポイントで{success, data, message}形式に統一
• エラー時のHTTPステータスコードを適切に設定
• レスポンスのバリデーションを追加
```
