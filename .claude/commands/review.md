# レビュー依頼

## 概要

マージ先ブランチとの差分を分析し、レビュー観点を整理する対話型コマンドです。

## 実行手順

### 1. 思考レベルの選択

レビューの詳細度を選択できます。以下のオプションから番号を選択してもらってください：

```text
思考レベルを選択してください：
1. 🧠 Basic (基本) - 素早い基本的なレビュー
2. 🧠🧠 Detailed (詳細) - 詳細な分析とレビュー
3. 🧠🧠🧠 Deep (深層) - 最も詳細な多角的レビュー

選択してください:
```

- ユーザーが番号を選択したら、対応する思考レベルを記録してください
- 1-3以外が入力された場合は「無効な番号です。もう一度番号を入力してください」と再入力を促してください

### 2. 現在の状態確認

- 現在のブランチと作業状況を把握してください

```bash
# 現在のブランチを確認
git branch --show-current

# 未コミットの変更を確認
git status --short
```

- 未コミットの変更がある場合は、それらも含めて差分を理解してください

### 3. 比較対象ブランチの選択と検証

- 現在のブランチ以外のローカルブランチを番号付きリストで提示してください

```bash
# ローカルブランチ一覧を取得（現在のブランチを除く）
git branch | grep -v '^\*' | sed 's/^  //'
```

- 番号付きリストを表示して、ユーザーに選択を求めてください
- ローカルブランチが現在のブランチのみの場合は「比較可能なローカルブランチがありません」と伝えてください
- ユーザーが番号を選択したら、対応するブランチとの差分を調査してください
- 候補にない番号が入力された場合は「無効な番号です。もう一度番号を入力してください」と再入力を促してください

### 4. 差分の調査と分析

選択されたブランチとの差分を調査し、以下の情報を収集してください：

```bash
# 1. 差分の統計情報を取得
git diff ${selected_branch}...HEAD --stat

# 2. 変更されたファイル一覧を取得
git diff ${selected_branch}...HEAD --name-status

# 3. コミット履歴の差分を確認
git log ${selected_branch}..HEAD --oneline
git log HEAD..${selected_branch} --oneline

# 4. 未コミットの変更を確認（ある場合）
git diff --staged
git diff

# 5. 実際の差分内容を取得して分析
git diff ${selected_branch}...HEAD
```

収集した情報をもとに、以下を理解してください：

- 現在のブランチで追加/変更された機能
- 選択したブランチから分岐後の変更内容
- 未コミットの作業内容
- レビューで注意すべき変更点

### 5. レビュー観点の整理

選択された思考レベルに応じて、以下の指示に従ってください：

- Level 1 (Basic) を選択した場合: **think** を使用してレビューを実行してください
- Level 2 (Detailed) を選択した場合: **think more** を使用してレビューを実行してください
- Level 3 (Deep) を選択した場合: **think harder** を使用してレビューを実行してください

変更内容を分析し、以下の形式でレビューポイントを整理してください：

```text
## レビュー概要

[選択された思考レベルに応じて以下のいずれかを表示]
🧠 思考モード: Basic (基本)
🧠🧠 思考モード: Detailed (詳細)
🧠🧠🧠 思考モード: Deep (深層)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━

### 変更情報
- 現在のブランチ: ${current_branch}
- マージ先: ${selected_branch}

### レビューチェックリスト

#### 機能の正確性
- [ ] 実装が要件を満たしているか
- [ ] エッジケースが考慮されているか
- [ ] エラーハンドリングが適切か

#### コード品質
- [ ] 命名規則に従っているか
- [ ] 重複コードはないか
- [ ] 可読性は確保されているか

#### パフォーマンス
- [ ] 不要な処理はないか
- [ ] 効率的なアルゴリズムか
- [ ] リソースの解放は適切か

#### セキュリティ
- [ ] 入力値検証が実装されているか
- [ ] 機密情報の取り扱いが適切か
- [ ] 脆弱性につながる実装はないか

#### テスト
- [ ] テストケースは十分か
- [ ] 境界値テストは含まれているか
- [ ] 既存テストは通るか
```
