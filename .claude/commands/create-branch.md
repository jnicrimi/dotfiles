# create-branch

## 概要

変更内容を分析し、適切なGitブランチを作成する

## ブランチ名規則

### 使用可能なprefix

| prefix | 説明 |
|---|---|
| feature | 新機能 |
| fix | バグ修正 |
| refactor | リファクタリング |
| docs | ドキュメント |
| chore | 雑務・メンテナンス |

### 命名規則

| ルール | 説明 | 例 |
|---|---|---|
| 形式 | `prefix/descriptive-branch-name` | `feature/user-authentication` |
| 区切り文字 | ハイフン使用 | `add-oauth-login` |
| 文字種 | 小文字のみ | `fix/auth-service` |
| 文字数制限 | 50文字以内を目安 | - |
| 対象の明示 | モジュール、サービス、ツール、ファイル名を含める | `fix/auth-service-timeout` |

## 実行手順

### 1. 変更内容の分析

```bash
# 変更ファイルを確認
git status

# ステージされた変更を分析
git diff --staged

# ステージされていない変更も確認
git diff
```

- 変更がない場合
  - 会話履歴から作業内容を推測してください

### 2. ブランチ名候補の提示

変更内容に応じて適切な数のブランチ名候補を提示してください

- **MUST**: すべてのブランチ名に必ず変更対象を含めてください
- **MUST**: 番号が若いほど推奨度を高くしてください
- **SHOULD**: 候補は詳細度や表現を変えて差別化
- **SHOULD**: 変更内容の複雑さに応じて、2〜6個程度の候補を提示することを推奨します

```text
════════════════════════════════════════
📊 分析結果
════════════════════════════════════════

[ステージされた変更、未ステージの変更、または会話履歴からの推測内容]
[会話履歴からの推測の場合は「※ 会話履歴から推測」と明記してください]

════════════════════════════════════════
🔀 おすすめのブランチ名
════════════════════════════════════════

1. prefix/branch-name-here
   理由: [選定理由]

────────────────────────────────────────────────────────────────────────────────

2. prefix/another-branch
   理由: [選定理由]

────────────────────────────────────────────────────────────────────────────────

... (必要に応じて追加)

────────────────────────────────────────────────────────────────────────────────

n. prefix/nth-option
   理由: [選定理由]

────────────────────────────────────────

▶ 選択してください
```

#### 出力例

##### 新機能の場合

```text
1. feature/user-authentication-system
   理由: ユーザー認証という対象が明確で簡潔

────────────────────────────────────────────────────────────────────────────────

2. feature/add-oauth-login-module
   理由: OAuth loginモジュールという対象を具体的に表現
```

##### バグ修正の場合

```text
1. fix/auth-service-error-handling
   理由: 認証サービスのエラー処理という対象が明確

────────────────────────────────────────────────────────────────────────────────

2. fix/user-validation-logic
   理由: ユーザー検証ロジックという対象を技術的に表現
```

##### リファクタリングの場合

```text
1. refactor/auth-module-structure
   理由: 認証モジュールという対象が明確で簡潔

────────────────────────────────────────────────────────────────────────────────

2. refactor/consolidate-user-auth-logic
   理由: ユーザー認証ロジックという対象と目的を明示
```

##### ドキュメントの場合

```text
1. docs/update-project-readme
   理由: プロジェクトREADMEという対象が明確

────────────────────────────────────────────────────────────────────────────────

2. docs/add-api-documentation
   理由: 追加内容を具体的に表現

────────────────────────────────────────────────────────────────────────────────

3. docs/improve-docker-setup-guide
   理由: Dockerセットアップガイドという対象を明示
```

##### 雑務・メンテナンスの場合

```text
1. chore/update-npm-dependencies
   理由: npmの依存関係という対象を明確に表現

────────────────────────────────────────────────────────────────────────────────

2. chore/upgrade-nodejs-runtime
   理由: Node.jsランタイムという対象を具体的に明示

────────────────────────────────────────────────────────────────────────────────

3. chore/claude-settings-optimization
   理由: Claude設定という対象を明確に表現
```

### 3. ブランチの作成

ユーザーが番号を選択したら以下の項目を実行してください

- 有効な番号が選択された場合
  - ブランチ名の妥当性を検証してください: `git check-ref-format --branch [branch-name]`
    - ブランチ名が不正な場合
      - エラーメッセージを出力して再入力を促してください
  - ブランチが既に存在するか確認してください: `git branch --list [branch-name]`
    - ブランチが既に存在する場合
      - 「ブランチは既に存在します。別の番号を選択してください」と再入力を促してください
    - ブランチが存在しない場合
      - 選択されたブランチ名でブランチを作成して切り替えてください: `git switch -c [branch-name]`
- 無効な番号が選択された場合
  - 「無効な番号です。もう一度番号を入力してください」と再入力を促してください
